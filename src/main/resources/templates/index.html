<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>test</title>
</head>
<body>
	<button type="button" onclick="sse();">SSE</button>
</body>
<script>
	window.onload = function() {
		fetch(
				"http://localhost:8090/login?id=&password=",
				{
					method : "POST",
				}).then(function(body) {
			return body.json();
		}).then(function(data) {
			console.log('결과= ', data);
		});

	}

	function sse() {
		const jwtToken = getCookie('JWT_TOKEN');
		console.log('token: ', jwtToken)
		const eventSource = new EventSource('/api/user/alarm/response/list', {
			withCredentials : true,
			headers : {
				'Authorization' : 'Bearer ' + jwtToken
			}
		});

		eventSource.onopen = function(event) {
			console.log('SSE 연결이 열렸습니다.');
		};

		eventSource.onmessage = function(event) {
			console.log('받은 메시지:', event.data);
		};

		eventSource.onerror = function(event) {
			console.error('SSE 연결 중 오류 발생:', event);
			eventSource.close();
		};
	}

	function getCookie(name) {
		const value = `; ${document.cookie}`;
		const parts = value.split(`; ${name}=`);
		if (parts.length === 2) 
			return parts.pop().split(';').shift();
	}
</script>